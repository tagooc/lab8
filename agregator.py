import os
import subprocess
import sys

def run_command(command, description=""):
    """–ó–∞–ø—É—Å–∫–∞–µ—Ç –∫–æ–º–∞–Ω–¥—É –∏ –≤—ã–≤–æ–¥–∏—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç"""
    print(f"\nüéØ {description}")
    print(f"üíª –í—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è: {command}")
    
    try:
        if command.startswith("python"):
            result = subprocess.run(command, shell=True, check=True, capture_output=True, text=True)
        else:
            result = subprocess.run(command, shell=True, check=True, capture_output=True, text=True)
        
        if result.stdout:
            print(f"‚úÖ –í—ã–≤–æ–¥: {result.stdout}")
        if result.stderr:
            print(f"‚ö†Ô∏è  –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è: {result.stderr}")
            
        return True
    except subprocess.CalledProcessError as e:
        print(f"‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏ –∫–æ–º–∞–Ω–¥—ã: {e}")
        if e.stderr:
            print(f"üîç –î–µ—Ç–∞–ª–∏ –æ—à–∏–±–∫–∏: {e.stderr}")
        return False

def main():
    print("üöÄ –ó–∞–ø—É—Å–∫ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –ø–∞–π–ø–ª–∞–π–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –≥—Ä–∞—Ñ–∞...")
    
    # –®–∞–≥ 1: –°–±–æ—Ä–∫–∞ C++ –ø—Ä–æ–µ–∫—Ç–∞
    if not run_command("cmake --build build", "–°–±–æ—Ä–∫–∞ C++ –ø—Ä–æ–µ–∫—Ç–∞"):
        print("‚ùå –°–±–æ—Ä–∫–∞ –Ω–µ —É–¥–∞–ª–∞—Å—å, –ø—Ä–µ—Ä—ã–≤–∞–µ–º –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ")
        return
    
    # –®–∞–≥ 2: –ü–∞—Ä—Å–∏–Ω–≥ –≥—Ä–∞—Ñ–∞ –∏–∑ Google Sheets
    if not run_command("python graph_parse.py", "–ü–∞—Ä—Å–∏–Ω–≥ –≥—Ä–∞—Ñ–∞ –∏–∑ Google Sheets"):
        print("‚ö†Ô∏è  –ü–∞—Ä—Å–∏–Ω–≥ –≥—Ä–∞—Ñ–∞ –∑–∞–≤–µ—Ä—à–∏–ª—Å—è —Å –æ—à–∏–±–∫–æ–π, –ø—Ä–æ–¥–æ–ª–∂–∞–µ–º...")
    
    # –®–∞–≥ 3: –ü–æ–∏—Å–∫ –Ω–∞—á–∞–ª—å–Ω–æ–π –∏ –∫–æ–Ω–µ—á–Ω–æ–π —Ç–æ—á–µ–∫
    # if not run_command("python find_start_end.py", "–ü–æ–∏—Å–∫ –Ω–∞—á–∞–ª—å–Ω–æ–π –∏ –∫–æ–Ω–µ—á–Ω–æ–π —Ç–æ—á–µ–∫"):
    #     print("‚ö†Ô∏è  –ü–æ–∏—Å–∫ —Ç–æ—á–µ–∫ –∑–∞–≤–µ—Ä—à–∏–ª—Å—è —Å –æ—à–∏–±–∫–æ–π, –ø—Ä–æ–¥–æ–ª–∂–∞–µ–º...")
    
    # –®–∞–≥ 4: –ó–∞–ø—É—Å–∫ C++ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –¥–ª—è –ø–æ–∏—Å–∫–∞ –ø—É—Ç–∏
    if not run_command("./build/app", "–ó–∞–ø—É—Å–∫ –∞–ª–≥–æ—Ä–∏—Ç–º–∞ A* –¥–ª—è –ø–æ–∏—Å–∫–∞ –ø—É—Ç–∏"):
        print("‚ùå –ê–ª–≥–æ—Ä–∏—Ç–º A* –Ω–µ –≤—ã–ø–æ–ª–Ω–∏–ª—Å—è, –ø—Ä–µ—Ä—ã–≤–∞–µ–º –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ")
        return
    
    # –®–∞–≥ 5: –û—Ç—Ä–∏—Å–æ–≤–∫–∞ –ø—É—Ç–∏ –≤ —Ç–∞–±–ª–∏—Ü–µ
    if not run_command("python draw_path.py", "–û—Ç—Ä–∏—Å–æ–≤–∫–∞ –Ω–∞–π–¥–µ–Ω–Ω–æ–≥–æ –ø—É—Ç–∏ –≤ —Ç–∞–±–ª–∏—Ü–µ"):
        print("‚ö†Ô∏è  –û—Ç—Ä–∏—Å–æ–≤–∫–∞ –ø—É—Ç–∏ –∑–∞–≤–µ—Ä—à–∏–ª–∞—Å—å —Å –æ—à–∏–±–∫–æ–π")
    
    # –®–∞–≥ 6: –û–∂–∏–¥–∞–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–≥–æ –≤–≤–æ–¥–∞
    print("\nüìù –ü—É—Ç—å –æ—Ç—Ä–∏—Å–æ–≤–∞–Ω –≤ —Ç–∞–±–ª–∏—Ü–µ.")
    print("üí° –ï—Å–ª–∏ —Ö–æ—Ç–∏—Ç–µ –æ—á–∏—Å—Ç–∏—Ç—å –ø—É—Ç—å, –≤–≤–µ–¥–∏—Ç–µ 'done'")
    print("üí° –î–ª—è –≤—ã—Ö–æ–¥–∞ –≤–≤–µ–¥–∏—Ç–µ –ª—é–±–æ–π –¥—Ä—É–≥–æ–π —Ç–µ–∫—Å—Ç")
    
    user_input = input("üéÆ –í–∞—à –≤–≤–æ–¥: ").strip().lower()
    
    if user_input == "done":
        # –®–∞–≥ 7: –û—á–∏—Å—Ç–∫–∞ –ø—É—Ç–∏
        if not run_command("python clear_path.py", "–û—á–∏—Å—Ç–∫–∞ –ø—É—Ç–∏ –∏–∑ —Ç–∞–±–ª–∏—Ü—ã"):
            print("‚ö†Ô∏è  –û—á–∏—Å—Ç–∫–∞ –ø—É—Ç–∏ –∑–∞–≤–µ—Ä—à–∏–ª–∞—Å—å —Å –æ—à–∏–±–∫–æ–π")
        else:
            print("‚úÖ –ü—É—Ç—å —É—Å–ø–µ—à–Ω–æ –æ—á–∏—â–µ–Ω!")
    else:
        print("üëã –í—ã—Ö–æ–¥ –±–µ–∑ –æ—á–∏—Å—Ç–∫–∏ –ø—É—Ç–∏")
    
    print("\nüéâ –ü–∞–π–ø–ª–∞–π–Ω –∑–∞–≤–µ—Ä—à–µ–Ω!")

if __name__ == "__main__":
    main()